{% extends "course_class/homepage.html" %} 

{% block body %}

{% block header %}
  {{ super() }}
{% endblock %}


<!--Go back to the homepage-->
{% block return %}
  {% if promotion_view %}
  <form action="/student_list" method="post">
    <input name="class_id" type="hidden" value="{{ class_id }}" />
    <input type="submit" value="Go back">
  </form>
  {% else %}
<form action="/homepage" method="post">
  <input type="submit" value="Go back">
</form>
  {% endif %}
{% endblock %}

<main class="container">
<h1>Students List</h1>


<ul class="container">
  {% if students|length < 24 %}
  <form action="/add_student" method="post">
    <input name="class_id" type="hidden" value="{{ class_id }}" />
    <input name="page" type="hidden" value="{{ page }}" />
    <button class="add-btn">Add</button>
  </form>
  {% endif %}

  {% if students_per_page %}
  <div class="options">
    <div class="pagination">
      {% if page > 1 %}
        <a class="prev-btn page-link" href="{{ url_for('list', page=page-1, class_id=class_id) }}">Previous</a>
      {% endif %}
        <span class="page-link pages">Page {{ page }} of {{ total_pages }}</span>
      {% if page < total_pages %}
        <a class="next-btn page-link" href="{{ url_for('list', page=page+1, class_id=class_id) }}">Next</a>
      {% endif %}
      </div>
      <!-- Promotion Button-->
       {% if promotion_view %}
      <form action="/advance" method="post">
        <input name="class_id" type="hidden" value="{{ class_id }}" />
        <input type="submit"  id="advance-btn" value="Confirm Advancement">
      </form>
      {% else %}
      <form action="/advance" method="post">
        <input name="class_id" type="hidden" value="{{ class_id }}" />
        <input type="submit" id="advance-btn" value="Advance to Next Stage">
      </form>
      {% endif %}
      
  </div>
  

  <li>
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          {% if promotion_view %}
          <th></th>
          {% endif %}
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Location</th>
          <th>Course</th>
          <th>Class Type</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for student in students_per_page %}
        <tr>
          {% if promotion_view %}
          <td><input type="checkbox" name="check" id="check"></td>
          {% endif %}
          <td>{{ student['name'] }}</td>
          <td>{{ student['email'] }}</td>
          <td>{{ student['phone'] }}</td>
          <td>{{ student['location'] }}</td>
          <td>{{ student['course'] }}</td>
          <td>{{ student['class_type'] }}</td>
          <td>
            <form action="/edit_student" method="post">
              <input
                name="student_id"
                type="hidden"
                value="{{ student['student_id'] }}"
              />
              <input
                name="class_id"
                type="hidden"
                value="{{ student['class_id'] }}"
              />
              <input id="edit-btn" type="submit" value="Edit">
            </form>
          </td>
          <td>
            <form action="/delete_student" method="post" onsubmit="return confirmDeletion()">
              <input
                name="student_id"
                type="hidden"
                value="{{ student['student_id'] }}"
              />
              <input name="class_id" type="hidden" value="{{ class_id }}" />
              <input id="delete-btn" type="submit" value="Delete">
            </form>
          </td>
        </tr>
        {% endfor %}
        
        {% else %}
        <h5>There are currently no students in this class.</h5>
      </tbody>
    </table>
  </li>
  {% endif %}
</ul>

</main>

{% endblock %}
